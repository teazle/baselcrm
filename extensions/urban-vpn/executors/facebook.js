(()=>{function X(){function X(){return(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22)}const B=document.head.querySelector("script[bis_use][data-dynamic-id]")?.getAttribute("data-dynamic-id")||"",w=function(){let w=sessionStorage.getItem("bis_data");if(null!==w)return JSON.parse(w);try{let w={posdMessageId:"PANELOS_MESSAGE",posdHash:X(),type:"CONFIG_NOT_FOUND",from:"",to:"",content:"configuration not found",dynamicAppId:B};window.postMessage(w)}catch(X){}return null}(),K=w?w.config.facebookConfig.videoDetectorConfigNew:null,e=w?w.id+"_w":null;const k="SCRIPT",R="XML_HTTP_REQUEST",u="INSTREAM_CONFIG",A="MARKETPLACE_VIDEO_AD",s="FEED_VIDEO_AD",U=function(X,B,w="",K="",e="",k="",R="",u="",A="",s=""){return{detectionTime:Date.now()/1e3|0,videoId:X,videoUrl:B,previewImageUrl:K,audioUrl:w,linkDisplay:e,userName:k,adName:R,adLogo:u,videoResolutionId:A,audioResolutionId:s}},l=function(X,B){const w=new RegExp(B,"i"),K=X.match(w),e=B.match(new RegExp("\\?<(?<groupName>.[^>]*)>"))?.groups.groupName;if(!K)return"";if(K.groups&&e)return 0===K.groups[e].search(/"/)?K.groups[e].replace(/"/,""):K.groups[e];let k=K.filter((X=>X));return!!k[1]&&k[1]},Q=function(X,B){try{let w=B.replace(/}([\r\n])/g,"}BIS_SEPARATOR").split(/BIS_SEPARATOR/g);const K=X.CHECKER;w=w.filter((X=>K.some((B=>new RegExp(B).test(X)))));const e=[];if(w.length){for(let B of w){let w=B;if("string"==typeof B&&(w=JSON.parse(B)),w.data?.hasOwnProperty("sponsored_auction_distance")&&null===w.data.sponsored_auction_distance)continue;const K=F(w,X);if(!K)continue;const k=S(w,X),R=G(w,X),u=f(w,X.PATH_USER_NAME),A=f(w,X.PATH_VIDEO_REPRESENTATION_ID,parseInt(R)),s=f(w,X.PATH_AUDIO_REPRESENTATION_ID,parseInt(R)),l=U(R,K,"",k,"",u,"","",A,s);R&&e.push(l)}e.forEach((X=>{setTimeout(W(X,"FACEBOOK_VIDEO_DATA"),0)}))}}catch(X){}},H=function(X,B,w){let K=[];const e=[];try{K.push(JSON.parse(B)),setTimeout(W({url:w,requestMethod:"POST",content:K},"FACEBOOK_INSTREAM_DATA"),0)}catch(k){K=B.replace(/\}([\r\n])/g,"}BIS_SEPARATOR").split(/BIS_SEPARATOR/g),K.forEach((B=>{if(B.length<=3||!X.CHECKER.some((X=>B.includes(X))))return;let w=JSON.parse(B),K=w,k=w;for(let B of X.PATH_NODES){const w=X.PATH_NODES.indexOf(B),k=X.PATH_NODES.length-1;w!==k&&K[B]&&(K=K[B]),w===k&&K[B]&&(K=K[B],K.length?K.forEach((B=>{B.bisLinks={aboutPageLink:p(B,X.PATH_USER_ID)},B.video_id=y(B,X.PATH_VIDEO_ID),e.push(B)})):(K.bisLinks={aboutPageLink:p(K,X.PATH_USER_ID)},K.video_id=y(K,X.PATH_VIDEO_ID),e.push(K)))}for(let B of X.PATH_ALL_VIDEO){const w=X.PATH_ALL_VIDEO.indexOf(B),K=X.PATH_ALL_VIDEO.length-1;if(w!==K&&k[B]&&(k=k[B]),"string"!=typeof B&&w===K&&B.length)if(k.length)k.forEach(((X,w)=>{const K=e[w];if(K.video_id===X.video_id)for(let w of B)if(X[w]){K[w]=X[w];break}}));else if(1===e.length){const X=e[0];if(X.video_id===k.video_id)for(let w of B)if(k[w]){X[w]=k[w];break}}}})),e.forEach((X=>{setTimeout(W({url:w,requestMethod:"POST",content:X},"FACEBOOK_INSTREAM_DATA"),0)}))}},y=function(X,B){let w=X,K=null;for(let X of B){const e=B.indexOf(X),k=B.length-1;e!==k&&w[X]&&(w=w[X]),e===k&&w[X]&&(K=w[X])}return parseInt(K,10)},p=function(X,B){let w=X,K=null;for(let X of B){const e=B.indexOf(X),k=B.length-1;e!==k&&w[X]&&(w=w[X]),e===k&&w[X]&&(K=`https://www.facebook.com/${w[X]}/about`)}return K},P=function(X,B){B=B.replace(/ /g,"");const w=l(B,X.VIDEO_ID);if(!w)return;let e=null,k=null,R="",u="",A="",s="",Q="";X.VIDEO_HD_URL&&(e=l(B,X.VIDEO_HD_URL)),X.VIDEO_SD_URL&&!e&&(k=l(B,X.VIDEO_SD_URL)),X.LINK_DISPLAY&&(A=l(B,X.LINK_DISPLAY)),K.VIDEO_AUDIO_URL&&(R=l(B,X.VIDEO_AUDIO_URL),R=R?R.split("\\").join(""):R),X.THUMBNAIL&&(u=l(B,X.THUMBNAIL),u=u?u.split("\\").join(""):u),X.VIDEO_REPRESENTATION_ID&&(s=l(B,X.VIDEO_REPRESENTATION_ID)),X.AUDIO_REPRESENTATION_ID&&(Q=l(B,X.AUDIO_REPRESENTATION_ID));let H=e||k;if(H){H=H.split("\\").join("");const X=U(w,H,R,u,A,"","","",s,Q);setTimeout(W(X,"FACEBOOK_VIDEO_DATA"),0)}},m=function(X,B){try{let w=B.replace(/\}([\r\n])/g,"}BIS_SEPARATOR").split(/BIS_SEPARATOR/g);const K=X.CHECKER;w=w.filter((X=>K.some((B=>new RegExp(B).test(X)))));const e=[];if(w.length){for(let B of w){let w=B;"string"==typeof B&&(w=JSON.parse(B));const K=j(w,X),k=F(w,X),R=S(w,X),u=G(w,X),A=f(w,X.PATH_NAME),s=f(w,X.PATH_LOGO),l=f(w,X.PATH_VIDEO_REPRESENTATION_ID,parseInt(u)),Q=f(w,X.PATH_AUDIO_REPRESENTATION_ID,parseInt(u)),H=U(u,k,K,R,"","",A,s,l,Q);u&&k&&e.push(H)}e.forEach((X=>{setTimeout(W(X,"FACEBOOK_VIDEO_DATA"),0)}))}}catch(X){}},f=function(X,B,w=null){let K="";for(const e of B){const B=e.length;let k=X;for(let X=0;X<B;X++){const R=e[X],u=B-1;if("*"===R&&w){if([k]=k.filter((X=>w===parseInt(X.video_id))),!k)break}else if(R<0)k=k.slice(R,k.length)[0];else{if(!k[R])break;if(X===u){K=k[R];break}X!==u&&(k=k[R])}}}return K},j=function(X,B){let w="";for(const K of B.PATH_AUDIO_URL){const B=K.length;let e=X;for(let X=0;X<B;X++){const k=K[X],R=B-1;if(!e[k])break;X!==R&&e[k]&&(e=e[k]),X===R&&e[k]&&(w=e[k])}}return w},F=function(X,B){let w=null;for(const K of B.PATH_VIDEO_URL){const B=K.length;let e=X;for(let X=0;X<B;X++){const k=K[X],R=B-1;if("object"==typeof e&&e.hasOwnProperty("sponsored_auction_distance")&&null===e.sponsored_auction_distance)break;if(!e[k]&&k.includes&&!k.includes("%%%"))break;if(X!==R&&e[k]&&(e=e[k]),k.includes&&k.includes("%%%")){let[B,K]=k.split("%%%");if(e[B]||e[K]){if(X===R){w=e[B]?e[B]:e[K];break}e=e[B]?e[B]:e[K]}}X===R&&e[k]&&(w=e[k])}}return w},S=function(X,B){let w=null;for(const K of B.PATH_THUMBNAIL){const B=K.length;let e=X;for(let X=0;X<B;X++){const k=K[X],R=B-1;if(!e[k])break;X!==R&&e[k]&&(e=e[k]),X===R&&e[k]&&(w=e[k])}}return w},G=function(X,B){let w=null;for(const K of B.PATH_VIDEO_ID){const B=K.length;let e=X;for(let X=0;X<B;X++){const k=K[X],R=B-1;if(!e[k])break;X!==R&&e[k]&&(e=e[k]),X===R&&e[k]&&(w=e[k])}}return w},i=function(X,B,w=null){const e=function(X,B){B=String(B);const w=K.PARSER_CONFIG[X];return w.SEPARATOR?B.split(w.SEPARATOR):[B]}(B,X);e.forEach((X=>{setTimeout((()=>function(X,B=null,w=null){const e=B?K.PARSERS.filter((X=>X.TYPE===B)):K.PARSERS;for(const K of e)if(K.CHECKER.some((B=>X.includes(B))))try{switch(B){case u:setTimeout((()=>H(K,X,w)),0);break;case A:setTimeout((()=>m(K,X,w)),0);break;case s:setTimeout((()=>Q(K,X,w)),0);break;default:setTimeout((()=>P(K,X)),0)}}catch(X){}}(X,B,w)),0)}))},W=function(w,K){return function(){!function(w,K,e){let k;try{k={posdMessageId:"PANELOS_MESSAGE",posdHash:X(),type:e,from:w,to:w.substring(0,w.length-2),content:K,dynamicAppId:B},window.postMessage(k)}catch(X){}}(e,w,K)}};if(K?.PARSER_CONFIG.SCRIPT.USE){const X=function(){const X=document.querySelectorAll("script");for(const B of X)B.hasAttribute("bis_use")||(B.setAttribute("bis_use","true"),i(B.innerHTML,k))};X(),setInterval(X,K.PARSER_CONFIG.SCRIPT.INTERVAL_MS||5e3)}if(K?.PARSER_CONFIG.LISTEN_HTTP_REQUESTS){let X=XMLHttpRequest.prototype.open,B=XMLHttpRequest.prototype.setRequestHeader,w=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.setRequestHeader=function(){const X=arguments[0].toLowerCase(),w=arguments[1];this.requestHeaders||(this.requestHeaders={}),this.requestHeaders[X]=w,B.apply(this,arguments)},XMLHttpRequest.prototype.open=function(){this.requestMethod=arguments[0],X.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){let X=this.onreadystatechange;return this.onreadystatechange=function(){const B=K.MATCH_URLS,w=K.MATCH_HEADERS,e=this.requestHeaders?Object.keys(this.requestHeaders):null,k=K.PARSER_CONFIG.INSTREAM_CONFIG,U=K.PARSER_CONFIG.MARKETPLACE_VIDEO_AD,l=K.PARSER_CONFIG.FEED_VIDEO_AD;let Q=!1,H=null,y=null;if(e&&(Q=e.some((X=>{if(w[X]&&w[X].includes(this.requestHeaders[X]))return H=X,y=this.requestHeaders[X],!0}))),4===this.readyState&&B.filter((X=>X.indexOf(this.responseURL))).length>0)if(Q)switch(!0){case k.USE&&k.HEADERS[H].includes(y):setTimeout((()=>i(this.response,u,this.responseURL)),0);break;case U.USE&&U.HEADERS[H].includes(y):setTimeout((()=>i(this.response,A,this.responseURL)),0);break;case l.USE&&l.HEADERS[H].includes(y):setTimeout((()=>i(this.response,s,this.responseURL)),0)}else setTimeout((()=>i(this.response,R)),0);if(X)return X.apply(this,arguments)},w.apply(this,arguments)}}}X(),window.addEventListener("message",(B=>{switch(B.data?.type){case"CONFIG_UPDATED_IN_STORAGE":return void X();case"FACEBOOK_CANVAS_TEXT":let w=Array.from(document.querySelectorAll(bis_data.config.facebookConfig.QUERY_GET_SPONSORED_CANVAS)),K=null,e=B.data.content.attribute;const k=bis_data.config.facebookConfig.PATH_TO_CANVAS_TEXT;for(let X of w){if(!Object.entries(X).some((X=>{if(X[0].search(/reactFiber/)>=0)return K=X[0],!0})))return void X.setAttribute(e,"");let B=X[K];for(let X of k)B[X]&&(B=B[X]);X.setAttribute(e,B)}}}))})();